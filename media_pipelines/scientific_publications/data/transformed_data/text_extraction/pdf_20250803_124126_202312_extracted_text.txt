Exploring Instructive Physiological Signaling with the Bioelectric Tissue Simulation Engine

Alexis Pietak and Michael Levin*
Allen Discovery Center at Tufts University, Medford, MA, USA

Bioelectric cell properties have been revealed as powerful targets for modulating stem cell function, regenerative response, developmental patterning, and tumor reprogramming. Spatio-temporal distributions of endogenous resting potential, ion flows, and electric fields are influenced not only by the genome and external signals but also by their own intrinsic dynamics. Ion channels and electrical synapses (gap junctions) both determine, and are themselves gated by, cellular resting potential. Thus, the origin and progression of bioelectric patterns in multicellular tissues is complex, which hampers the rational control of voltage distributions for biomedical interventions. To improve understanding of these dynamics and facilitate the development of bioelectric pattern control strategies, we developed the BioElectric Tissue Simulation Engine (BETSE), a finite volume method multiphysics simulator, which predicts bioelectric patterns and their spatio-temporal dynamics by modeling ion channel and gap junction activity and tracking changes to the fundamental property of ion concentration. We validate performance of the simulator by matching experimentally obtained data on membrane permeability, ion concentration and resting potential to simulated values, and by demonstrating the expected outcomes for a range of well-known cases, such as predicting the correct transmembrane voltage changes for perturbation of single cell membrane states and environmental ion concentrations, in addition to the development of realistic transepithelial potentials and bioelectric wounding signals. In silico experiments reveal factors influencing transmembrane potential are significantly different in gap junction-networked cell clusters with tight junctions, and identify non-linear feedback mechanisms capable of generating strong, emergent, cluster-wide resting potential gradients. The BETSE platform will enable a deep understanding of local and long-range bioelectrical dynamics in tissues, and assist the development of specific interventions to achieve greater control of pattern during morphogenesis and remodeling.

[PAGE 1] INTRODUCTION

1.1. Bioelectricity: Why Model Electrical Activity in Non-Neural Cells?

Explaining and learning to control large-scale pattern is a central unsolved problem, with implications for mitigation of birth defects, and the advancement of regenerative medicine and synthetic bioengineering. The dynamics of signals orchestrating large-scale order in vivo are a key area of research, as understanding these signals is an essential first step in developing interventions that alter anatomical outcomes. The dynamics of chemical signals and their gradients are becoming increasingly well-understood (Reingruber and Holcman, 2014; Slack, 2014; Werner et al., 2015). However, endogenous bioelectric signals represent a parallel regulatory system that exerts instructive control over large-scale growth and form. Recent work has demonstrated that ionic and bioelectrical signaling of various cell types underpins a powerful system of biological pattern control [reviewed in Nuccitelli (2003a), McCaig et al. (2005), Levin (2012, 2014), Levin and Stephenson (2012), and Tseng and Levin (2013)]. Importantly, endogenous bioelectric gradients across tissues can be a very early pre-pattern for subsequent transcriptional and morphogenetic events. For example, during craniofacial development of frogs, specific transmembrane voltage (Vmem) patterns determine the downstream shape changes and gene expression domains of the developing face (Vandenberg et al., 2011; Adams et al., 2016) and brain (Pai et al., 2015). Furthermore, experimental modulation of cell Vmem states can radically alter large-scale anatomy, for example, inducing eye formation in ectopic body areas, such as the gut, where the master eye regulator Pax6 cannot induce eyes (Pai et al., 2012), reprogramming the regeneration blastemas of planaria to produce heads instead of tails (Beane et al., 2011), or rescuing normal brain patterning despite the presence of mutated neurogenesis genes, such as Notch (Pai et al., 2015).

[PAGE 2] 1.2. Local and Long-Range Order in Bioelectrical Networks

On the scale of single cells, the Vmem spanning every living cell's plasma membrane is a demonstrated regulator of key processes, such as cell proliferation (Blackiston et al., 2009), programmed cell death (Boutillier et al., 1999; Wang et al., 1999), and differentiation (Ng et al., 2010), and is known to be a factor in the activation of immune cells (Bronstein-Sitton, 2004). For example, despite the action of growth factors, stem cells have been inhibited from differentiation by preventing the cells from developing a hyperpolarized Vmem (Sundelacruz et al., 2008). The bioelectric properties of single cells are fairly well-understood (Lodish et al., 2000; Wright, 2004). However, bioelectric states often regulate large-scale anatomical properties, such as axial polarity (Marsh and Beams, 1952; Beane et al., 2011), organ size (Perathoner et al., 2014) and shape (Beane et al., 2013), and induction of formation of whole appendages (Adams et al., 2007; Tseng et al., 2010). Moreover, pattern control involves long-range coordination of bioelectric states. In metastatic conversion (Morokuma et al., 2008; Blackiston et al., 2011; Lobikin et al., 2012), tumor suppression (Chernet and Levin, 2014; Chernet et al., 2015), brain size regulation (Pai et al., 2015), and head-tail polarity in planarian regeneration (Beane et al., 2011), the patterning outcome in one region of the animal is a function of the bioelectric states of both local and remote cells. Thus, it is imperative to understand not only how ion channel and pump activity controls single-cell electrical properties but also how electrical gradients self-organize, propagate, and evolve in multicellular networks. Moreover, understanding the origin of developmental order also requires that we understand how tissue-level gradients of bioelectric properties arise.

In a multicellular collective, endogenous patterns of Vmem and electric fields provide positional information and achieve long-range coordination of cell activity. As in the central nervous system, this occurs because cells in a tissue are not isolated, but are electrochemically connected (and, therefore, communicating) in several ways, including intracellular channels known as gap junctions [GJ (Goodenough and Paul, 2009)], and by ephaptic coupling created by local field potentials, which enable one cell's Vmem activity to influence that of its neighbor's (Zhou et al., 2012). These connections between cells create bioelectrical circuits involving long-range signal patterns through whole structures, which have been determined crucial for developing embryos (Jaffe, 1981; Hotary and Robinson, 1990; Hotary and Robertson, 1994; Shi and Borgens, 1995), normal limb development of animals (Altizer et al., 2001), healing of wounds (Nuccitelli, 1992, 2003a; McCaig et al., 2005; Zhao, 2009), and even in continuous tumor suppression in adult animals (Chernet and Levin, 2013, 2014). The ability for cells to couple and communicate makes local changes to cell Vmem relevant in terms of long-range signals capable of affecting the whole. Likewise, the inability for cells to form communication networks, for instance, due to improper expression or function of GJ connections, is observed in disease processes, such as cancer (Leithe et al., 2006; Trosko, 2007). Even briefly altering the bioelectric connectivity of a cellular network enables rewriting of an organism's target morphology. For example, genomically normal fragments of planarian flatworms can be induced to regenerate heads with shapes and internal anatomy belonging to other extant species (Emmons-Bell et al., 2015), or changed to a two-headed form that regenerates with two heads in perpetuity, illustrating the ability to stably re-wire bioelectric circuits with permanent changes to the overall anatomy (Oviedo et al., 2010).

Another important bioelectrical signal relevant to multicellular clusters is a voltage gradient known as the trans-epithelial potential (TEP), which forms at the outer boundary of an organ or organism. The TEP is also implicated in normal developmental processes (Shi and Borgens, 1995), wound healing (Zhao, 2009), and disease processes, such as cystic fibrosis (Hay and Geddes, 1985), fungal infection (Gow and Morris, 1995), inflammation, and cancer (Soler et al., 1999). The TEP is created when multicellular structures develop impermeable tight junctions (TJ) between cells at the exterior boundary (Hay and Geddes, 1985); disruptions to this process induce electric fields that serve as guidance cues for many migratory cell types during injury response (McCaig, 1990; Zhao, 2009; Yamashita, 2013) and limb development (Borgens, 1984; Borgens et al., 1987). Understanding plasma membrane voltage gradients and transepithelial potentials, and their spatio-temporal transitions in vivo, is a key enabling step for the field of developmental bioelectricity and its applications.

[PAGE 2] 1.3. Modeling: The Need for In Silico Simulation

Understanding and learning to control patterning signals requires a quantitative appreciation of their intrinsic dynamics and the way they evolve through time. Since the pioneering work of Turing (Turing, 1952; Raspopovic et al., 2014; Watanabe and Kondo, 2015), much effort has gone into mathematical modeling of the dynamics of biochemical signals and their gradients. While there are many platforms for modeling spiking activity in the brain (Bower and Beeman, 2007), there are few available frameworks for formulating predictive models of bioelectric signaling during slower processes involved in somatic cell pattern regulation (Cervera et al., 2016), and even fewer working from the more biorealistic perspective of ionic concentrations and movements, rather than an equivalent electric circuit model. Such biorealistic models are crucial if we are to develop effective interventions that target powerful bioelectric control processes. Furthermore, ion channels and GJs are themselves voltage-sensitive (Nau, 2008; Palacios-Prado and Bukauskas, 2009). This means that cell groups can implement highly non-linear behaviors and feedback loops that are too complex to predict or control by direct inspection. While recent efforts have begun to model some of the interesting behavior of these GJ-coupled dynamical systems (Cervera et al., 2014, 2015; Law and Levin, 2015), there is a need for a flexible, powerful platform to facilitate in silico experimentation and model-building, and for connecting bioelectric dynamics with other aspects of physiology, physical forces, and genetic networks.

[PAGE 3] The availability of a realistic modeling system for bioelectricity will enable (1) formulation of models of specific patterning events based on realistic physiological and channel expression data, (2) design of predicted intervention strategies for inducing desired changes in electrical state and downstream patterning outcomes, and (3) investigation of the broader capabilities of non-neural bioelectrical networks for use in synthetic biology (Doursat and Sanchez, 2014; Kamm and Bashir, 2014; Mustard and Levin, 2014) and unconventional computation architectures (Adamatzky and Jones, 2011; Adamatzky et al., 2012).

As a core component of enabling the unraveling of the bioelectrical dynamics of tissues in this exciting emerging field, we have created the Bio-Electric Tissue Simulation Engine (BETSE) to quantitatively explore bioelectrical signals in networked cell collectives. BETSE integrates a diverse range of mechanisms and physiologies to enable model building and hypothesis testing at a level congruent with experimental observables, including electrodiffusion of multiple ions under chemical and electrical gradients in various contexts; consideration of concentration, charge, voltage, and current in both intra- and extracellular networks in order to capture important signals, such as tissue-wide endogenous ion currents, TEP, and local field potentials; and dynamic control of membrane permeability and gap junction state to simulate voltage and ligand-gated channels. This work is the first in a series of studies modeling specific patterning systems, and using BETSE to infer targeted modulation strategies. Here, we discuss the design of BETSE, validate BETSE's bioelectrical modeling performance, and provide some insights into the fundamental mechanisms involved in patterning of networked multicellular clusters.


[PAGE 3] 2. MATERIALS AND METHODS

[PAGE 3] 2.1. Model Overview


Whether working with metals, semiconductors, or the salt-water electrolyte of biological systems, voltages (electric potential energies) are created by net electrical charge. In typical electrical systems, such as metals and semiconductors, the charge carriers are electrons or the absence of electrons (holes). In electrolytes, ions from dissolved salts can develop concentration profiles generating net charge in a region of space and, therefore, create voltages. Furthermore, mass flux of ions can generate a net current, which is associated with intracellular and tissue-wide electric fields. Therefore, ions are the fundamental units of the bioelectrical system, and their concentrations, mass fluxes, and transport mechanisms are ultimately important. BETSE can consider ions relevant to most living systems: Na+, K+, Cl¯, Ca2+, HCO₃⁻, H+, and charged macromolecules, such as proteins (X¯). In addition, BETSE can consider the movement of a charged biomolecule, such as a voltage reporter dye, glutamate, serotonin or inositol triphosphate (symbolized as Yn¯ or Yn+, where n is a variable charge number) present at low concentrations and, therefore, assumed to not affect voltage directly due to its inconsequential contribution to local charge density.

Cells create and control Vmem by selectively altering ion fluxes across their membrane. Ion pumps, such as the sodium potassium pump (Na/K-ATPase), use free-energy released from ATP hydrolysis to move ions across the insulating cell membrane, creating net ionic charge density and voltage gradients inside and outside of the cell, similar to a self-charging capacitor (Veech et al., 1995). Ion channels in the plasma membrane allow charge to move under these concentration and voltage gradients, altering charge densities and thereby changing the concentration and voltage gradients to create bioelectrical signals. At its core, BETSE keeps track of ion concentrations and ion fluxes in space and time, reducing them to net charge distributions inside and outside of the cell, using these net charges to calculate voltages inside and outside of the cellular space, calculating changes to concentrations resulting from ion mass fluxes resulting from concentration/voltage gradients and by active ion pumps, and calculating endogenous currents from the net mass flux of ions. Membrane permeability to specific ions is used as a dynamic variable to simulate the action of specific ion channels (including K+ leak channels, calcium gated K+ and Cl¯ channels, and voltage-gated Na+, K+, and Ca2+ channels).

[PAGE 4] The following details how electro-diffusive transport, voltage calculations, ion pumps, ion channel dynamics, voltage-sensitive GJ, and electroosmotic flows are handled in BETSE. Further details regarding BETSE's underlying theory and implementation can be found in Supplementary Material. Table 1 summarizes key parameter and typical variable values and their units. A highly simplified schematic of the “bioelectric circuit" implemented in BETSE is shown in Figure 1.

[PAGE 4] 2.2. BETSE Platform and Performance

BETSE is a finite volume method multiphysics simulation platform, uniquely specialized to work with a range of bioelectric phenomena arising in biological tissues, which are highly spatially heterogeneous by nature.

BETSE was implemented in Python 3.4, making heavy use of the scientific and engineering toolboxes Numpy, Scipy, and Matplotlib (Millman and Aivazis, 2011).

To make each time step of a simulation as quick as possible, BETSE uses matrix-based differential equation solvers, making memory one of the limitations of simulation size and extent. Simulating a square millimeter of tissue (~10,000 cells) with all features enabled (e.g., extracellular space simulation, electroosmotic fluid flow, all ion types included) uses approximately 14 Gb of RAM, and is considered the current limit of simulation size.

BETSE code is available from the public repository: http://ase.tufts.edu/biology/labs/levin/resources/software.htm

[PAGE 5] 2.3. Core Mathematical Strategy

Biological tissue represents a challenging modeling scenario due to its highly heterogeneous nature, where closely spaced (~10-30 nm), membrane bound, electrolyte-filled cells are individually interacting with a small extracellular space at individual plasma membranes, and where the extracellular spaces connect with a continuous, aqueous environment at the cell cluster boundary. Individual cells are also connected internally via transmembrane channels, such as GJ, which enable passage of small molecules and ionic current between cells. To manage this involved biophysical situation, BETSE uses an irregular Voronoi diagram-based cell grid, embedded within a regular square environmental grid, to model the heterogeneous nature of tissues, while also allowing modeling of a continuous environmental space around the cell cluster (Figure 2A).

Each modeled cell in the cell grid has a center point (indicated in grid diagrams as A, see Figure 2), where scalar cell properties, such as concentration (ci) and intracellular voltage (Vcell) are defined. Each cell also has a unique volume (volcell) and perimeter representing the cell membrane. This allows unique membrane properties, such as Vmem, to be defined for each segment of each individual cell membrane, thereby opening the possibility for study of individual cell polarizations and self-electrophoresis/electroosmosis of membrane-bound ion pumps and channels (Jaffe, 1981; McLaughlin and Poo, 1981).

Membrane-specific scalar and vector properties are defined at each membrane segment midpoint (indicated as * in Figure 2B). Each membrane segment also has normal and tangent unit vectors. The membrane midpoints of each cell interface with the central points of local environmental grid squares (red "o" in Figure 2) via a nearest-neighbor interpolation scheme. A weighting function (cell membranes seen per grid square) is used to properly assign the mole transfer for a mass flux between cell and environment, thereby conserving mass and charge of the system (see Supplementary Material for more information).

The interconnected grid systems of BETSE, which models individual cells as discrete patches, make it possible to shape the cluster into complex forms and to cut holes into the cell cluster (before or during a simulation). Holes in the tissue represent the continuous electrolyte in the region of the hole. This enables study of simple vasculature (e.g., capillaries feeding the tissue by diffusion from the environment), cysts (such as the model shown in Figure 2A), and wounding. BETSE uses bitmaps to define the shape of the cluster, cut holes, and to assign specific properties (i.e., membrane permeability) to desired regions of the modeled tissue (see Supplementary Material).

The core mathematical operators of differential equations used in BETSE are:

• gradient (∇sj), which calculates the degree of change in the spatial property over space at grid point j
• divergence (∇ · Fj), which measures the amount of outward flow of a vector field from each point in space, measuring the presence of a source (+ divergence) or sink (- divergence) at grid point j, and
• the Laplacian (∇²sj = ∇ · ∇sj), which is most intuitively expressed as the divergence of the gradient of a scalar property. When discretized, the Laplacian is a matrix, which can be inverted to give the inverse of the operation, such that if ∇²Sj = cj then Sj = ∇⁻²cj.

[PAGE 5] Discrete versions of gradient, divergence, and Laplacian/inverse Laplacian were defined, using standard finite difference and finite volume techniques (Schafer, 2006), on the cell and environmental grids. These core mathematical operators were then used where required in specific differential equation expressions.

The detailed features of the cell and environmental grids, the specific definition of the above mathematical operators on each of the grids, and the interaction between the cell and environmental grid models, are discussed in Supplementary Material.


[PAGE 5] FIGURE 1 | The fundamental "bioelectrical circuit" implemented in BETSE, shown on a simplified geometry of two triangular cells (1 and 2) surrounded by their respective extracellular spaces (3-7). Note that in BETSE, and in contrast to the simplified image shown, cells are defined from a Voronoi diagram and are polygonal with four or more membranes, and that a larger network of 10-1000 cells is considered in simulations. Each cell-extracellular junction has a capacitive component (membrane capacitance Cm), a "resistive" component (cell membrane diffusion coefficients, Dm), and a variable current source (representing the action of pumps, ip). Transfer between two cells occurs via GJ, which are represented by a "resistive" component (Dgj). Transfer between extracellular spaces and to the environment is handled using "resistive" components (Do). Boundary conditions at the global environmental boundary are represented by grounded voltage (V = 0) and fixed concentrations representing an open boundary with Dirichlet conditions. Self-capacitances for each cell and extracellular space are not shown.

FIGURE 2 | BETSE computations use an irregular Voronoi-based cell grid interacting with a regular square environment grid to model heterogeneous tissues (A). The cell grid is composed of cell center ("A") and membrane points ("*") (B). Membranes that lack a neighboring cell (and, therefore, interact only with the global environment) are identified using a boundary search algorithm. The environmental grid consists of regularly spaced points ("o") which are tagged as being internal or external to the cell cluster (B). The intercellular spaces of the cell grid are assumed to be connected to the extracellular environment by fluxes or gradients (A), which use points interpolated between the cell membrane and environmental grid midpoints with a weighting function (cell membranes seen per grid square) to properly assign the mole transfer for a mass flux between cell and environment (B).

[PAGE 6] 2.4. Bio-Electrochemical Mass Transport

Ion transport in bioelectrical systems is influenced by gradients of both concentration (∇ci) and voltage (∇V), with ions passively moving by a process known as electrodiffusion – a combination of regular diffusion and electrophoretic transport. In general, electrodiffusion is described by the Nernst-Planck differential equation, describing the rate of change in the concentration ci of an ion i with charge zi and diffusion constant Di:

∂ci/∂t = ∇ · (Di∇ci + (Di zi q/kbT) ci∇V - u ci)      (1)

here, u is a fluid flow [e.g., electroosmotic flow field (Andreev, 2013)], q is the electron charge constant, kb is the Boltzmann constant, and T is the temperature (see Table 1).

Ions are actively transported by pumps in the cell membrane. Both passive and active transport processes generate ion fluxes (Φi). These combined fluxes can lead to changes in concentration and charge density, and can generate a system-wide ionic current density J.

BETSE assumes passive electrodiffusive mass transport in a multicellular cluster follows three distinct pathways: (1) transmembrane, via intra- and extracellular spaces across the plasma membrane; (2) intercellular, between cellular spaces via gap junctions; and (3) extracellular, between extracellular spaces and within the global environment (Figure 3). Active transport from ion pumps is always assumed to be transmembrane. Therefore, BETSE considers the following sources of ion flux for an ion i:

• Transmembrane, from passive electrodiffusive transport resulting from gradients between the local intra- and extracellular spaces using the Goldman-Hodgkin-Katz Flux equation (GHK Flux equation), which is derived from the Nernst-Planck Differential equation for the case of electrodiffusion across a cell membrane for a non-steady-state Vmem (Bowman and Baglioni, 1984):

Φmem,i = (zi Vmem F Di / RT dmem) * (Ccelli / (1-exp(-ziVmemF/RT)) - Cenvi exp(-ziVmemF/RT) / (1-exp(-ziVmemF/RT)))      (2)

here, F is the Faraday constant, R is the ideal gas constant, and dmem is the plasma membrane thickness (see Table 1). Positive fluxes are directing mass into cells.

[PAGE 7] • Transmembrane, from active transport resulting from ion pump activity. Details of how the dynamic ion pump rates (α) are calculated are given in section 2.7:

Φpump,i = α(Ccelli, Cenvi, Vmem, t)      (3)

Positive fluxes are directing mass into cells.

• Intercellular, from passive electrodiffusive transport resulting from gradients between neighboring, GJ networked cells:

Φcell,i = -Di∇Ccelli - (Di zi q/kbT) Ccelli∇Vcell + ucell Ccelli      (4)

• Extracellular, from passive electrodiffusive transport resulting from gradients between neighboring environmental spaces:

Φenv,i = -Di∇Cenvi - (Di zi q/kbT) Cenvi∇Venv + uenv Cenvi      (5)

Changes in concentration are made by assuming the concentration change in an ion i depends on the divergence of the net (Φtot,i) sum of all fluxes of the ion entering or changing in a particular region of the space (i.e., cells or environment):

∂ci/∂t = -∇ · Φtot,i      (6)

Net ionic charge density was calculated by summing all ion concentrations at a region of space:

ρe = F Σ (zi Ci)      (7)

The dynamics of ionic charge density were calculated from the mass flux of all ions:

∂ρe/∂t = -F Σ (zi Φi)      (8)

The total current density of the environment or cell, J, was calculated using the continuity equation in combination with the assumption of bulk electro-neutrality for electrolytes due to charge screening. Using the Continuity equation for current, the current density in a region follows:

∇ · J + ∂ρe/∂t = 0      (9)

As electro-neutrality (zero net charge density) must be preserved in the bulk electrolyte, the base current density calculated by BETSE (J0) was corrected by assuming that an internal electric field develops in the bulk electrolyte as a result of charge screening, which is the negative gradient of an electric potential Vint:

J = J0 - σ∇Vint      (10)

Substituting equation (10) into equation (9) and rearranging to solve for the internal electric potential:

∇²Vint = (1/σ) ∂ρe/∂t      (11)

After obtaining Vint, it is used with equation (10) to produce the corrected current density for the system. Current density in the environment and in cell spaces was treated as separate.

Note that as movement in both concentration and electrical gradients can occur, the transport properties of bioelectrical systems cannot be strictly reduced to electrical constants, such as resistance or conductance. However, examining the Nernst-Planck equation [equation (1)] reveals that the diffusion coefficient D is able to serve as the constant of proportionality for movement in both chemical and electrical terms. In the absence of a concentration gradient, and multiplying by F z to convert mass flux to ionic current density, the Nernst-Planck Flux equation reduces to:

J = -(F²z²Di/kbT) Ci ∇V      (12)

Noting that the definition of an electric field is É = -∇V, equation (12) parallels the equation relating current density to electric field via media conductivity σ:

J = -σÉ      (13)

Therefore, BETSE makes use of diffusion constants to characterize ion transport in different regions of the multicellular cluster, but can approximate conversions between conductivity and the diffusion constant.

Note that for movement across a membrane with thickness dmem, the permeability of the membrane is simply Pmem = Dmem/dmem.

[PAGE 7] 2.5. Biological Voltages

[PAGE 7] 2.5.1. Bioelectric Voltage Calculations Using a Maxwell Capacitance Matrix

The Poisson equation (∇²V = -ρe/ε, where ρe is electronic charge density and ε is medium electrical permittivity) is typically used to determine voltage from charge density. In air, a charged object will emanate a voltage gradient (electric field) into the space around it according to the Poisson equation. However, electrolytes are more complex. Due to the presence of mobile, oppositely charged ions in electrolytes, objects with steady-state voltages or bound charges collect an opposite surface charge from the electrolyte to form an electrical double layer approximately 1-nm thick in biological systems, which screens the voltage/charge of the object and prevents a long-range electrical field from developing at macroscopic distances into the electrolyte (Bazant and Squires, 2004). Moreover, biological systems are highly heterogeneous, with opposite-sign charge distributed at intra- and extracellular interfaces of the plasma membrane. This means opposite sign charges are separated by the small membrane thickness (3.5-9 nm), and that in a collective of many cells with closely interfacing membranes, charges are present in the low-volume extracellular space that is approximately 5–50-nm wide between cells. Therefore, a new technique was adopted to model voltage in the biological tissue. Voltages in the intra- and extracellular spaces (Vintra, Vextra), and the related Vmem = Vintra - Vextra, were calculated from net ionic surface charge distributions using a 

[PAGE 8] formulation called the Maxwell Capacitance Matrix (Clements et al., 1975; Heinzel, 2008).

Capacitance is typically known in terms of an electrical device characterized by two metal plates (electrical conductors) with equal and opposite charge (±Q) on either plate, which are separated by a layer of insulating material (Figure 4A). The capacitance (C) is defined by the ratio of the voltage (V) between the plates in relation to the charge Q on each plate (Figure 4A):

C = Q/V      (14)

However, arrangements of conductors can involve capacitance via multiple insulator-separated conductors with variable amounts of charge and voltage on each conductor (Figure 4B). For the case of multiple conductors, the basic capacitance relation shown in equation (14) must be extended to parameterize more complex arrangements. For instance, for the three conductors shown in Figure 4C, the charge Q on each conductor can be related to voltages and capacitances of the system as:

QA = Cm(VA - V0) + CsaVA
QB = Cm(VB - V0) + CsbVB
Q0 = Cm(V0 - VA) + Cm(V0 - VB) + Cs0V0      (15)

here, Cm is a capacitance connecting the conductors, and Csa, Csb, and Cs0 are the self-capacitances of the conducting objects.

[PAGE 9] The self-capacitance of a conductor describes how much charge is acquired on the conductor/unit voltage applied to its surface. For electrolytes, self-capacitance is related to the ability of the electrolyte to screen voltage on a submerged object (see Figure 4B). Using Boltzmann relations for low voltages, in an electrolyte the ionic charge density ρe forming near the surface of an object with a surface voltage Φ0 can be expressed as a function of distance, x, away from the surface as:

ρe(x) = -ε0 εr κ² Φ0 exp(-κx)      (16)

where κ is the inverse Debye length for the electrolyte, which assuming the approximation for a symmetric monovalent electrolyte with total molar concentration Ctot for a typical BETSE system is expressed:

κ = √(2 F² Ctot / εr ε0 RT) ≈ 1.2x10⁹ m⁻¹      (17)

Integrating equation (16) with respect to x from the surface at 0 to infinity, and dividing by the surface voltage to approximate a self-capacitance/unit surface area for surfaces in the electrolyte:

Cself = ρe/Φ0 = ε0εrκ ≈ 0.86 F/m²      (18)

The system of linear equations derived when considering more complex arrangements of insulator-separated conductors can be expressed in a matrix form (Heinzel, 2008). For the highly simplified system shown in Figure 4B, and described by equation (15), the Maxwell Capacitance matrix (M) interrelating charge Qk and voltage Vk on each conductor is:


```
[ Cm + Csa   0      -Cm ] [ VA ]   [ QA ]
[  0       Cm + Csb  -Cm ] [ VB ] = [ QB ]
[ -Cm      -Cm    2Cm + Cs0] [ V0 ]   [ Q0 ]

Q = MV
V = M⁻¹Q
```

For the case where the set of charges Q are known, the corresponding set of voltages V can be found by calculating the pseudo-inverse of the Maxwell Capacitance matrix (M⁻¹) using a singular-value decomposition method.

In the biological system, we propose every point of contact between two cells represents a situation similar to the one shown in Figure 4C. In order to calculate voltage within the closely spaced intra- and extracellular regions, and to thereby derive Vmem for a cell cluster, each cell-cell interface is reduced to a capacitive electrical system consisting of three conductors: two intracellular spaces and one extracellular space, which are each separated by two cell membranes with capacitance Cmem. Each space has net ionic charge Qk and voltage Vk. The self-capacitance of each space is related by equation (18). This allows a Maxwell Capacitance Matrix identical to the one defined above to be constructed for a single cell-cell junction (Figure 4D).

In BETSE, a typical cell cluster consists of many hundred to thousand cell-cell interfaces and, therefore, has a very large M, the pseudo-inverse of which was used to calculate voltage in each intra- and extracellular space from net charge Qk in each region. To complete the calculation, Vmem are calculated by taking the difference between the intra- and extracellular voltages at a respective membrane point.

Note that the use of the Maxwell Capacitance Matrix to derive Vmem is only one component of the computation of bioelectrical variables – a simplified bioelectrical "circuit" is shown in Figure 1, and must also include electrodiffusive transport of ions via transmembrane, intercellular, and extracellular networks, in addition to active transport of ions by pumps, as described in section 2.4.

[PAGE 9] 2.5.2. Assumptions Regarding the Biological Electric Field

It is important to clarify that while it is well known that the ions of electrolytes screen voltages arising from static charge distributions, thereby preventing electric field (voltage gradient) from static charge distributions from being seen past the electrical double layer, any net ionic current density (J) arising from ion fluxes in the biological system is known to generate a small magnitude observable macroscopic electric field (Eglobal) according to:

Églobal = γJ      (20)

where γ represents the media resistivity of approximately 0.02 Ωm. These endogenous currents and related global electric fields have been observed directly and are on the magnitude from 1 to 1000 μA/cm² and exist in the extra- and intracellular spaces (De Loof, 1985; Nuccitelli, 1992, 2003a,b; Altizer et al., 2001).

BETSE assumes the existence of two types of electric field (voltage gradient) in the biological tissue (Figure 3B). At the microscopic scale (i.e., 10s of nanometers), very strong voltage gradients are assumed to exist across membranes, gap junctions, and between extracellular spaces (especially across tight junctions) due to the presence of charge at interfaces separated by distances of 10s of nanometers (Figure 3B). These electric fields, with strength on the order of 0.01-1.0 million volts/meter, are assumed to be the primary drivers of ion flux across membranes and junctions, however, are very short acting due to electrolyte screening. On mesoscopic scales (i.e., 10–100s of micrometers) net ionic current density is assumed to be associated with a longer range, weaker electric field via equation (20) (Figure 3B), which is of much lower strength on the order of 0.2 volts/meter. BETSE assumes the current densities in the environment and in the cell networks are separate.

[PAGE 9] 2.6. Standard Equations for Voltage Cross-Check and Validation

[PAGE 9] 2.6.1. Nernst Equation

In cell physiology, two additional equations have been derived from the Nernst-Planck equation for use in specific situations involving transport across a membrane: the Nernst equation (Matthews, 2013a) and the Goldman equation (alternatively known as the GHK equation) (Matthews, 2013b).

For the case where the system consists of two compartments separated by a semi-permeable membrane, and the system is at steady-state with both zero ion flux and zero current across the membrane, the Nernst equation (21) can be used to predict the voltage or ratio of concentrations across a membrane:

Vmem = (zRT/F) ln(Cext/Cint)      (21)

Note that the Nern